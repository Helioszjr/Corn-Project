---
title: "PROJETO MILHO"
author: "Helio Junior"
date: '2022-04-07'
output: html_document
editor_options: 
  chunk_output_type: console
---

# AULA 4

## Introdução ao R/qtl

O pacote R é uma ferramenta importante para quem trabalha com linkage e mapeamento QTL.

Para usar, precisará instalá-lo primeiro. Podemos fazer isso usando a função. Em seguida, podemos carregar o pacote em R usando a função: qtlinstall.packageslibrary


### Análise de ligação I: segregação de marcadores, cálculo da fração de recombinação dois-pontos, e formação dos grupos de ligação.

```{r}
library(qtl)
```

## Dados do milho

```{r}
population_Z006 <- read.cross(format="csv", file="population_z006.csv", genotypes=c("0","1","2"), crosstype = "riself")
```

Para executar a análise com os dados do mouse, precisamos carregar o conjunto de dados usando uma função específica do pacote chamado . Também podemos usar funções associadas, como e inspecionar os dados com mais cuidado:qtlread.crosssummarygeno.image

#### -DADOS:
#####	 185  individuos
#####	 1106  marcadores
#####	 29  fenótipos

```{r}
summary(population_Z006)
```

```{r}
geno.image(population_Z006)
```

Agora, calculamos os testes qui-quadrado para ver o quão bem os dados se encaixam na segregação esperada de 1:2:1:

```{r}
gt.population_z006 <- geno.table(population_Z006)
gt.population_z006
```

```{r}
table(gt.population_z006$P.value < 0.05)
```

## FALSE  TRUE 
## 947   159

```{r}
table(gt.population_z006$P.value < 0.05/totmar(population_Z006))
```

A partir da correção bonferroni dos testes de segregação realizados, notamos que não há segregação distorcida entre os 14 marcadores.

Agora, podemos estimar frações de recombinação usando a função e usar a função para ver os resultados: est.rfplotRF

E, finalmente, estimamos as frações de recombinação em pares:

```{r}
population_Z006 <- est.rf(population_Z006)
plotRF(population_Z006, col.scheme = "redblue")
```

Este mapa de calor apresenta tanto o rr estimativas (acima de diagonal) e escores de LOD (abaixo da diagonal).

Uma vez que as frações de recombinação de pairwise tenham sido computadas, podemos tentar ver se esses marcadores estão ligados ou não. Para fazê-lo, assumimos que os marcadores estão ligados se r<0,38r<0,38 e LOD>6LOD>3:

```{r}
population_Z006 <- formLinkageGroups(population_Z006, max.rf=0.38, min.lod=6)
table(population_Z006[,2])
```

A partir da função, notamos que apenas 10 grupo é formado, o que significa que todos os 1000 marcadores do conjunto de dados do milho são do mesmo cromossomo.table













# AULA 5

## Análise de ligação II: ordenação dos marcadores

Precisamos carregar o conjunto de dados usando a função:read.cross

```{r}
population_Z006 <- read.cross(format="csv", file="population_z006.csv", genotypes=c("0","1","2"), crosstype = "riself")
```

Antes de fazer qualquer pedido, precisamos calcular as frequências de recombinação de dois pontos (usando ):est.rf

```{r}
population_Z006 <- est.rf(population_Z006)
```

E, com base nas frequências de recombinação de dois pontos, pedimos ao software que procure marcadores no mesmo grupo de linkagem:

```{r}
population_Z006 <- formLinkageGroups(population_Z006, max.rf = 0.38, min.lod=6, reorgMarkers=TRUE) 
                                
```

Agora, usamos a função para obter um pedido para os marcadores em cada grupo de linkage (temos apenas um grupo de linkage como identificado em nossa última classe). Primeiro, com:orderMarkersripple = FALSE

```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 1, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 2, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 3, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 4, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 5, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 6, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 7, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 8, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 9, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```


```{r}
population_Z006 <- orderMarkers(population_Z006, chr = 10, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006, col.scheme = "redblue", mark.diagonal = TRUE)
```

A partir do mapa de calor, parece ter um marcador extraviado porque algumas das frações de recombinação entre par de marcadores são ainda menores do que aquelas próximas à diagonal.

Vamos primeiro dar uma olhada na ordem atual. Para isso, usamos a função:pull.map

```{r}
pull.map(population_Z006, chr=1, as.table = TRUE)
pull.map(population_Z006, chr=2, as.table = TRUE)
pull.map(population_Z006, chr=3, as.table = TRUE)
pull.map(population_Z006, chr=4, as.table = TRUE)
pull.map(population_Z006, chr=5, as.table = TRUE)
pull.map(population_Z006, chr=6, as.table = TRUE)
pull.map(population_Z006, chr=7, as.table = TRUE)
pull.map(population_Z006, chr=8, as.table = TRUE)
pull.map(population_Z006, chr=9, as.table = TRUE)
pull.map(population_Z006, chr=10, as.table = TRUE)
```

Note que alguns marcadores parecem um pouco desligados, certo? Para verificar se eles estão em sua posição mais provável ou não, devemos comparar a probabilidade de log ("loglik") da ordem atual com as de ordens alternativas.

Então, primeiro, vamos ver qual é o loglik atual:

Olhar para a probabilidade de log atual ("loglik") é:

```{r}
attr(population_Z006$geno$`1`$map, "loglik")
attr(population_Z006$geno$`2`$map, "loglik")
attr(population_Z006$geno$`3`$map, "loglik")
attr(population_Z006$geno$`4`$map, "loglik")
attr(population_Z006$geno$`5`$map, "loglik")
attr(population_Z006$geno$`6`$map, "loglik")
attr(population_Z006$geno$`7`$map, "loglik")
attr(population_Z006$geno$`8`$map, "loglik")
attr(population_Z006$geno$`9`$map, "loglik")
attr(population_Z006$geno$`10`$map, "loglik")
```

Agora, vamos tentar algumas ordens alternativas. Primeiro, podemos usar para procurar inversões locais (o que parece ser o caso, por sinal):ripple = TRUE

```{r}
memory.limit(9999999999)
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=1, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=2, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=3, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=4, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=5, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=6, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=7, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=8, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=9, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

```{r}
population_Z006 <- orderMarkers(population_Z006, chr=10, use.ripple = TRUE, map.function="kosambi")
plotRF(population_Z006, mark.diagonal = TRUE, col.scheme = "redblue")
```

Novamente, parece ter um marcador extraviado porque algumas das frações de recombinação entre par de marcadores são ainda menores do que aquelas próximas à diagonal.

Vamos primeiro dar uma olhada na ordem atual. Para isso, usamos a função:pull.map

```{r}
pull.map(population_Z006, chr=1, as.table = TRUE)
pull.map(population_Z006, chr=2, as.table = TRUE)
pull.map(population_Z006, chr=3, as.table = TRUE)
pull.map(population_Z006, chr=4, as.table = TRUE)
pull.map(population_Z006, chr=5, as.table = TRUE)
pull.map(population_Z006, chr=6, as.table = TRUE)
pull.map(population_Z006, chr=7, as.table = TRUE)
pull.map(population_Z006, chr=8, as.table = TRUE)
pull.map(population_Z006, chr=9, as.table = TRUE)
pull.map(population_Z006, chr=10, as.table = TRUE)
```


```{r}
attr(population_Z006$geno$`1`$map, "loglik")
attr(population_Z006$geno$`2`$map, "loglik")
attr(population_Z006$geno$`3`$map, "loglik")
attr(population_Z006$geno$`4`$map, "loglik")
attr(population_Z006$geno$`5`$map, "loglik")
attr(population_Z006$geno$`6`$map, "loglik")
attr(population_Z006$geno$`7`$map, "loglik")
attr(population_Z006$geno$`8`$map, "loglik")
attr(population_Z006$geno$`9`$map, "loglik")
attr(population_Z006$geno$`10`$map, "loglik")
```


Legal! O grupo de ligação é menor e a probabilidade é maior do que a ordem anterior.

Finalmente, uma maneira de desenhar o mapa de linkage é usando a função:plotMap

```{r}
population_Z006 <- flip.order(population_Z006, chr = 1)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 2)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 3)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 4)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 5)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 6)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 7)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 8)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 9)
plotMap(population_Z006, show.marker.names=TRUE)
```


```{r}
population_Z006 <- flip.order(population_Z006, chr = 10)
plotMap(population_Z006, show.marker.names=TRUE)

```

Se quisermos ver onde os crossovers foram parar para os primeiros 10 indivíduos ao longo do mapa de linkage, então usamos a função:plotGeno

```{r}
plotGeno(population_Z006, chr = 1 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 2 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 3 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 4 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 5 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 6 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 7 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 8 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 9 , ind = 1:10)
```


```{r}
plotGeno(population_Z006, chr = 10 , ind = 1:10)
```
O azul × indicam que um crossover aconteceu nesse intervalo










# AULA 6

## Modelo de regressão linear

## Análise de marcador único usando base R

```{r}
library(readr)
population_Z006 <- read_csv("population_Z006.csv")
head(population_Z006)
```

```{r}
population_Z006 <- population_Z006[-c(1),]
head(population_Z006)
```


## Modelo de regressão linear

```{r}
summary(lm(PlantHeight ~ PlantHeight, data = population_Z006))
```


```{r}
plot(PlantHeight ~ jitter(PlantHeight, .5), xlab = "PlantHeight", xaxt = "n", data = population_Z006)
axis(1, at = c(0, 1, 2), labels = c("0\n(mm)", "1\n(Mm)", "2\n(MM)"), tcl = 0.5)
abline(lm(PlantHeight ~ PlantHeight, data = population_Z006))
```

```{r}
population_Z006.a <- population_Z006[,2:13]-1
head(population_Z006.a)
```

```{r}
summary(lm(population_Z006[,"PlantHeight"] ~ population_Z006.a[,1]))
```








# AULA 7

## Ordenando marcadores usando pacotes R/qtl e MDSmap+MAPpoly

# Construção do mapa de ligação

```{r}
population_Z006 <- read.cross(format="csv", file="population_z006.csv", genotypes=c("0","1","2"), crosstype = "riself")
```

```{r}
population_Z006 <- est.rf(cross = population_Z006)
plotRF(population_Z006, col.scheme = "redblue")
```

# Agrupamento de marcadores

```{r}
max.rf <- 0.38
kosambi <- function(r) (1/4)*log((1+(2*r))/(1-(2*r)))
kosambi(r = max.rf)
```

```{r}
(M <- totmar(population_Z006))
```

```{r}
(num.pair <- choose(M, 2))
```

```{r}
(min.lrt <- qchisq(1-(0.05/num.pair), 1))
```

```{r}
(min.lod <- 0.2172 * min.lrt)
```

```{r}
lg <- formLinkageGroups(population_Z006, max.rf=max.rf, min.lod=min.lod, reorgMarkers=FALSE)
table(lg[,2])
```

```{r}
population_Z006 <- formLinkageGroups(population_Z006, max.rf=0.38, min.lod=6.25, reorgMarkers=TRUE)
plotRF(population_Z006, col.scheme = "redblue")
```
O mapa de calor mostra marcadores agrupados, mas ainda não ordenados, dentro de cada grupo de ligação.


# Pedido de marcador

## Usando orderMarkersa função por R/qtl

```{r}
population_Z006.bb1 <- population_Z006
```


```{r}
population_Z006.bb2 <- population_Z006
```


```{r}
loglik.bb1 <- loglik.bb2 <- c()
```

# Grupo de ligação 1

```{r}
c <- 1
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 2
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 3
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 4
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 5
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 6
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 7
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 8
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 9
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
c <- 10
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))

```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

# Grupo de ligação 1

```{r}
c <- 1
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Grupo de ligação 2

```{r}
c <- 2
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```

# Grupo de ligação 3

```{r}
c <- 3
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```

# Grupo de ligação 4

```{r}
c <- 4
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```

# Grupo de ligação 5

```{r}
c <- 5
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Grupo de ligação 6


```{r}
c <- 6
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Grupo de ligação 7

```{r}
c <- 7
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Grupo de ligação 8

```{r}
c <- 8
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```

# Grupo de ligação 9

```{r}
c <- 9
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Grupo de ligação 10


```{r}
c <- 10
plotRF(population_Z006, chr=c, col.scheme = "redblue")
```

```{r}
population_Z006.bb1 <- orderMarkers(cross = population_Z006.bb1, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb1, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb1, chr = c)
```

```{r}
(loglik.bb1[c] <- attr(population_Z006.bb1$geno[[c]]$map, "loglik"))
```

```{r}
population_Z006.bb2 <- orderMarkers(cross = population_Z006.bb2, chr=c, use.ripple = FALSE, map.function="kosambi")
plotRF(population_Z006.bb2, chr = c, col.scheme = "redblue")
```

```{r}
pull.map(population_Z006.bb2, chr = c)
```

```{r}
(loglik.bb2[c] <- attr(population_Z006.bb2$geno[[c]]$map, "loglik"))
```

```{r}
save.image("population_Z006.RData")
```


# Ajustes manuais da orderMarkers()saída

```{r}
knitr::kable(cbind(summaryMap(population_Z006.bb1), log.likelihood=c(loglik.bb1, sum(loglik.bb1))))
```

```{r}
plotMap(population_Z006.bb1)
save.image("population_Z006.RData")
```

```{r}
plotRF(population_Z006.bb1, col.scheme = "redblue")
save.image("population_Z006.RData")
```

```{r}
knitr::kable(cbind(summaryMap(population_Z006.bb2), log.likelihood=c(loglik.bb2, sum(loglik.bb2))))
```

```{r}
plotMap(population_Z006.bb2)
save.image("population_Z006.RData")
```

